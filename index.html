<html>
	<head>
		<title>Marcos Cobeña Morián</title>

        <!--<meta name="viewport" content="width=device-width, initial-scale=1.0" />-->
		
		<style type="text/css">
			body {
				color: #000;
				font-family: serif;
                font-size: 24px;
                line-height: 2em;
				margin: 0px auto;
                margin-top: 100px; margin-bottom: 100px;
				padding: 8;
    			width: 1160px;
			}

			.center {
				text-align: center;
			}

            #signature {
                text-align: right;
			}

            #title {
                margin: 0px 0px 100px 0px;
				text-transform: lowercase;
			}
		</style>
		
		<script src="scripts/jquery-3.1.1.min.js"></script>

		<!-- Path.js provides path (yeah...) handling to make this behave like an actual web app -->
		<script src="scripts/path.min.js"></script>

		<script src="scripts/showdown.min.js"></script>
		
		<script type="text/javascript"> 
			var items = [];
			var converter = new showdown.Converter();
			var baseDocumentTitle = "";
					
			function addItem(title, filename, date, hidden = false) {
				var item = { title: title, filename: filename, date: date, hidden: hidden };

				items.push(item);

				Path.map("#/" + filename)
					.to(function(){
					    loadItem(filename);
					})
					.enter(populateItems);
			}

			function entryPoint() {
				baseDocumentTitle = document.title;

				$("#items").change(function () {
					window.location.href = window.location.origin + "/#/" + this.value;
				});
			
				// At least we need a "home" item to serve as the landing one
				Path.root("#/home");

				Path.rescue(function () {
				    window.location.href = window.location.origin + "/#/404";
				});
					
				Path.listen();
			}
			
			function loadItem(filename) {
				var actualPath = "items/" + filename + ".md";
			
				$.get(actualPath, function (data) {
					var item = items.find(function(item) { 
						return item.filename == filename;
					});

					document.title = item.title + ' - ' + baseDocumentTitle;
		
					$("#title").html(item.title);
			
    				var body = converter.makeHtml(data);

					$("#actualBody").html(body);

                    var signature = '-Marcos<br />Internet, ' + item.date;

                    $("#signature").html(signature);

					window.scrollTo(0, 0);
				});
			}

			function populateItems()
			{
				$("#items").empty();
			
				//if (items.length == 0 ||
				//	(items.length == 1 && items[0].filename == "home")) {
				//	$("#items").append("<li><i>Nothing currently</i></li>");
				//
				//	return;
				//}

				$("#items").append("<option>Choose an article...</option>");
			
				for (var i = 0; i < items.length; i++) {
					var item = items[i];

					if (item.hidden)
						continue;
			
					var html = '<option value="' + item.filename + '">' + 
							item.title + ' - ' + item.date + 
						'</option>';
			
					$("#items").append(html);
				}
			}
		</script>

		<script src="items/items.js"></script>
	</head>
	<body onload='entryPoint()'>
		<div id="title" class="center">
		</div>
		
		<div id="actualBody">
		</div>

        <div id="signature">
		</div>

		<div class="center">
			<p>
				~
			</p>

			<select id="items">
			</select>
		</div>
	</body>
</html>